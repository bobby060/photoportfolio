(()=>{var e={};e.id=359,e.ids=[359],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12412:e=>{"use strict";e.exports=require("assert")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},25177:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>c,pages:()=>u,routeModule:()=>p,tree:()=>d});var a=r(65239),s=r(48088),o=r(88170),i=r.n(o),n=r(30893),l={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>n[e]);r.d(t,l);let d={children:["",{children:["new",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,51805)),"/home/bobby060/photoportfolio/src/app/new/page.js"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,78162))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,75535)),"/home/bobby060/photoportfolio/src/app/layout.js"],error:[()=>Promise.resolve().then(r.bind(r,92463)),"/home/bobby060/photoportfolio/src/app/error.js"],loading:[()=>Promise.resolve().then(r.bind(r,87273)),"/home/bobby060/photoportfolio/src/app/loading.js"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,78162))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,u=["/home/bobby060/photoportfolio/src/app/new/page.js"],c={require:r,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/new/page",pathname:"/new",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},37270:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var a=r(98654),s=r(3512),o=r(53437);let i=(0,a.D)();async function n(e,t,r=()=>{}){let a=["image/gif","image/jpeg","image/png"],l=0;async function d(t){if(!a.includes(t.type))return void console.warn(`file ${t.name} is not a valid file type!`);let n="",d={},u="";try{let a=new Image;a.src=window.URL.createObjectURL(t),await a.decode();let c=[a.naturalHeight,a.naturalWidth],p={title:t.name,desc:"",filename:t.name,date:new Date().toISOString(),albumsID:e.id,height:c[0],width:c[1]};try{let e=await i.graphql({query:o.r0,variables:{input:p}});n=(d=e?.data?.createImages).id,u=`${d.id}-${t.name}`}catch(e){console.warn("Error creating image: ",t.name,e);return}try{await (0,s.C)({key:u,data:t})}catch(e){console.warn("Image not uploaded. Error: ",e),await i.graphql({query:o.KK,variables:{input:{id:n}}});return}l+=1,r(l)}catch(e){console.warn("Error uploading image: ",t.name,e);return}console.log(`${t.name} sucessfully uploaded`)}if(t.length>0){let e=Array.from(t);console.log("starting uploads"),await Promise.all(e.map(e=>d(e))),console.log("All images uploaded!")}}},39193:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>g});var a=r(60687),s=r(43210),o=r(98654),i=r(22102),n=r(16189),l=r(53437),d=r(77466),u=r(31336),c=r(37270);r(5631);let p=(0,o.D)({authMode:"userPool"});function m(){let e=(0,n.useRouter)(),[t,r]=(0,s.useState)([]),[o,m]=(0,s.useState)("loading"),[g,h]=(0,s.useState)(!1),[b,f]=(0,s.useState)(0),[x,w]=(0,s.useState)("");async function y(e){r(e.target.files)}async function j(r){r.preventDefault(),h(!0);let a=new FormData(r.target),s=a.get("date")+"T00:00:00.000Z",o=new Date,i="T00:00:00.000Z"===s?o.toISOString():s,n=a.get("title"),m=0===n.length?`Album created at ${o.getMonth()+1}-${o.getDate()}-${o.getFullYear()} at ${o.getHours()}:${o.getMinutes()}`:n,g=(await p.graphql({query:d.v8,limit:1})).data.listImages.items[0].id,b={title:m,desc:a.get("desc"),date:i,albumsFeaturedImageId:g,type:"Album"},x=(await p.graphql({query:l.LF,variables:{input:b}})).data.createAlbums,y={id:(0,u.sL)(x),urlAlbumId:x.id};try{await p.graphql({query:l.cO,variables:{input:y}})}catch(e){console.log("failed to create url for new album",e),await p.graphql({query:l.yd,variables:{albumId:x.id}}),w("failed to create url for new album. Album deleted")}await (0,c.A)(x,t,f);try{let t=(await p.graphql({query:d.LS,variables:{albumsID:x.id,limit:1}})).data.imagesByAlbumsID.items[0],s={id:x.id,albumsFeaturedImageId:t.id};(await p.graphql({query:l.AP,variables:{input:s}})).data.updateAlbums,console.log(`Created new album named: ${a.get("title")}`),e.push("../"),r.target.reset()}catch(e){console.warn("failed to update featured img for new album. Album still created"),w("failed to update featured img for new album. Album still created"),r.target.reset()}}return(0,s.useRef)(!1).current?(0,a.jsx)("div",{children:(0,a.jsxs)(i.Dj,{className:"",children:[(0,a.jsx)("h2",{className:"mt-2",children:" Create new album "}),(0,a.jsxs)("form",{id:"createAlbumForm",onSubmit:j,children:[(0,a.jsxs)(i.gU,{className:" justify-content-center",children:[(0,a.jsxs)(i.m6,{xl:"3",lg:"5",md:"6",children:[(0,a.jsx)(i.gk,{className:"mb-3",label:"Title",name:"title",type:"text"}),(0,a.jsx)(i.gk,{className:"mb-3",label:"Date",name:"date",type:"date"})]}),(0,a.jsx)(i.m6,{xl:"3",lg:"5",md:"6",children:(0,a.jsx)(i.SM,{className:"mb-3",label:"Description",name:"desc",type:"text",rows:3})})]}),(0,a.jsx)(i.gU,{className:" justify-content-center",children:(0,a.jsx)(i.m6,{xl:"3",lg:"5",md:"6",children:(0,a.jsx)(i.C,{multiple:!0,onChange:y,className:"m-1 mb-3"})})}),(0,a.jsx)(function(){return t.length<1?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.al,{type:"submit",className:"bg-dark m-1",disabled:!0,children:"Create"}),(0,a.jsx)("p",{children:"Select photos to enable create button"})]}):(0,a.jsx)(i.al,{className:"bg-dark m-1",children:"Create"})},{})]}),g?(0,a.jsx)(function(){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.fs,{className:"mt-3"}),(0,a.jsxs)("p",{className:"fw-light",children:["Creating album and uploading photo ",b," of ",t.length]})]})},{}):(0,a.jsx)(a.Fragment,{}),(0,a.jsx)("p",{children:x})]})}):(0,a.jsx)(a.Fragment,{})}function g(){return(0,a.jsx)(m,{})}},51805:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});let a=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/bobby060/photoportfolio/src/app/new/page.js\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/bobby060/photoportfolio/src/app/new/page.js","default")},55511:e=>{"use strict";e.exports=require("crypto")},57264:(e,t,r)=>{Promise.resolve().then(r.bind(r,39193))},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{"use strict";e.exports=require("zlib")},75211:(e,t,r)=>{Promise.resolve().then(r.bind(r,51805))},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[447,715,658,654,131,89],()=>r(25177));module.exports=a})();