"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[78],{8045:(e,t,a)=>{a.d(t,{EK:()=>d,H1:()=>r,VQ:()=>s,fM:()=>u,nt:()=>l,ot:()=>o,wE:()=>i,z8:()=>c,zX:()=>n});let r="authorization",n="host",o="x-amz-date",i="x-amz-security-token",s="aws4_request",d="AWS4-HMAC-SHA256",l="AWS4",u="e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",c="UNSIGNED-PAYLOAD"},13971:(e,t,a)=>{var r;a.d(t,{q:()=>r,u:()=>n}),function(e){e.NoCredentials="NoCredentials",e.NoIdentityId="NoIdentityId",e.NoKey="NoKey",e.NoSourceKey="NoSourceKey",e.NoDestinationKey="NoDestinationKey",e.NoBucket="NoBucket",e.NoRegion="NoRegion",e.UrlExpirationMaxLimitExceed="UrlExpirationMaxLimitExceed",e.ObjectIsTooLarge="ObjectIsTooLarge",e.InvalidUploadSource="InvalidUploadSource"}(r||(r={}));let n={[r.NoCredentials]:{message:"Credentials should not be empty."},[r.NoIdentityId]:{message:"Missing identity ID when accessing objects in protected or private access level."},[r.NoKey]:{message:"Missing key in api call."},[r.NoSourceKey]:{message:"Missing source key in copy api call."},[r.NoDestinationKey]:{message:"Missing destination key in copy api call."},[r.NoBucket]:{message:"Missing bucket name while accessing object."},[r.NoRegion]:{message:"Missing region while accessing object."},[r.UrlExpirationMaxLimitExceed]:{message:"Url Expiration can not be greater than 7 Days."},[r.ObjectIsTooLarge]:{message:"Object size cannot not be greater than 5TB."},[r.InvalidUploadSource]:{message:"Upload source type can only be a `Blob`, `File`, `ArrayBuffer`, or `string`."}}},16078:(e,t,a)=>{a.d(t,{C:()=>ex}),a(88768),a(28848);var r=a(73623),n=a(13971),o=a(95677),i=a(16218);let s=e=>{if(null==e)return 0;if("string"==typeof e){let t=e.length;for(let a=t-1;a>=0;a--){let r=e.charCodeAt(a);r>127&&r<=2047?t++:r>2047&&r<=65535&&(t+=2),r>=56320&&r<=57343&&a--}return t}return"number"==typeof e.byteLength?e.byteLength:"number"==typeof e.size?e.size:void 0};var d=a(58563),l=a(46199),u=a(31204);let c=[0x67452301,0xefcdab89,0x98badcfe,0x10325476];class f{constructor(){this.reset()}update(e){var t,a;if("string"==typeof(t=e)?0===t.length:0===t.byteLength)return;if(this.finished)throw Error("Attempted to update an already finished hash.");let r="string"==typeof(a=e)?(0,u.a)(a):ArrayBuffer.isView(a)?new Uint8Array(a.buffer,a.byteOffset,a.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(a),n=0,{byteLength:o}=r;for(this.bytesHashed+=o;o>0;)this.buffer.setUint8(this.bufferLength++,r[n++]),o--,64===this.bufferLength&&(this.hashBuffer(),this.bufferLength=0)}async digest(){if(!this.finished){let{buffer:e,bufferLength:t,bytesHashed:a}=this,r=8*a;if(e.setUint8(this.bufferLength++,128),t%64>=56){for(let t=this.bufferLength;t<64;t++)e.setUint8(t,0);this.hashBuffer(),this.bufferLength=0}for(let t=this.bufferLength;t<56;t++)e.setUint8(t,0);e.setUint32(56,r>>>0,!0),e.setUint32(60,Math.floor(r/0x100000000),!0),this.hashBuffer(),this.finished=!0}let e=new DataView(new ArrayBuffer(16));for(let t=0;t<4;t++)e.setUint32(4*t,this.state[t],!0);return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}hashBuffer(){let{buffer:e,state:t}=this,a=t[0],r=t[1],n=t[2],o=t[3];a=p(a,r,n,o,e.getUint32(0,!0),7,0xd76aa478),o=p(o,a,r,n,e.getUint32(4,!0),12,0xe8c7b756),n=p(n,o,a,r,e.getUint32(8,!0),17,0x242070db),r=p(r,n,o,a,e.getUint32(12,!0),22,0xc1bdceee),a=p(a,r,n,o,e.getUint32(16,!0),7,0xf57c0faf),o=p(o,a,r,n,e.getUint32(20,!0),12,0x4787c62a),n=p(n,o,a,r,e.getUint32(24,!0),17,0xa8304613),r=p(r,n,o,a,e.getUint32(28,!0),22,0xfd469501),a=p(a,r,n,o,e.getUint32(32,!0),7,0x698098d8),o=p(o,a,r,n,e.getUint32(36,!0),12,0x8b44f7af),n=p(n,o,a,r,e.getUint32(40,!0),17,0xffff5bb1),r=p(r,n,o,a,e.getUint32(44,!0),22,0x895cd7be),a=p(a,r,n,o,e.getUint32(48,!0),7,0x6b901122),o=p(o,a,r,n,e.getUint32(52,!0),12,0xfd987193),n=p(n,o,a,r,e.getUint32(56,!0),17,0xa679438e),r=p(r,n,o,a,e.getUint32(60,!0),22,0x49b40821),a=y(a,r,n,o,e.getUint32(4,!0),5,0xf61e2562),o=y(o,a,r,n,e.getUint32(24,!0),9,0xc040b340),n=y(n,o,a,r,e.getUint32(44,!0),14,0x265e5a51),r=y(r,n,o,a,e.getUint32(0,!0),20,0xe9b6c7aa),a=y(a,r,n,o,e.getUint32(20,!0),5,0xd62f105d),o=y(o,a,r,n,e.getUint32(40,!0),9,0x2441453),n=y(n,o,a,r,e.getUint32(60,!0),14,0xd8a1e681),r=y(r,n,o,a,e.getUint32(16,!0),20,0xe7d3fbc8),a=y(a,r,n,o,e.getUint32(36,!0),5,0x21e1cde6),o=y(o,a,r,n,e.getUint32(56,!0),9,0xc33707d6),n=y(n,o,a,r,e.getUint32(12,!0),14,0xf4d50d87),r=y(r,n,o,a,e.getUint32(32,!0),20,0x455a14ed),a=y(a,r,n,o,e.getUint32(52,!0),5,0xa9e3e905),o=y(o,a,r,n,e.getUint32(8,!0),9,0xfcefa3f8),n=y(n,o,a,r,e.getUint32(28,!0),14,0x676f02d9),r=y(r,n,o,a,e.getUint32(48,!0),20,0x8d2a4c8a),a=h(a,r,n,o,e.getUint32(20,!0),4,0xfffa3942),o=h(o,a,r,n,e.getUint32(32,!0),11,0x8771f681),n=h(n,o,a,r,e.getUint32(44,!0),16,0x6d9d6122),r=h(r,n,o,a,e.getUint32(56,!0),23,0xfde5380c),a=h(a,r,n,o,e.getUint32(4,!0),4,0xa4beea44),o=h(o,a,r,n,e.getUint32(16,!0),11,0x4bdecfa9),n=h(n,o,a,r,e.getUint32(28,!0),16,0xf6bb4b60),r=h(r,n,o,a,e.getUint32(40,!0),23,0xbebfbc70),a=h(a,r,n,o,e.getUint32(52,!0),4,0x289b7ec6),o=h(o,a,r,n,e.getUint32(0,!0),11,0xeaa127fa),n=h(n,o,a,r,e.getUint32(12,!0),16,0xd4ef3085),r=h(r,n,o,a,e.getUint32(24,!0),23,0x4881d05),a=h(a,r,n,o,e.getUint32(36,!0),4,0xd9d4d039),o=h(o,a,r,n,e.getUint32(48,!0),11,0xe6db99e5),n=h(n,o,a,r,e.getUint32(60,!0),16,0x1fa27cf8),r=h(r,n,o,a,e.getUint32(8,!0),23,0xc4ac5665),a=b(a,r,n,o,e.getUint32(0,!0),6,0xf4292244),o=b(o,a,r,n,e.getUint32(28,!0),10,0x432aff97),n=b(n,o,a,r,e.getUint32(56,!0),15,0xab9423a7),r=b(r,n,o,a,e.getUint32(20,!0),21,0xfc93a039),a=b(a,r,n,o,e.getUint32(48,!0),6,0x655b59c3),o=b(o,a,r,n,e.getUint32(12,!0),10,0x8f0ccc92),n=b(n,o,a,r,e.getUint32(40,!0),15,0xffeff47d),r=b(r,n,o,a,e.getUint32(4,!0),21,0x85845dd1),a=b(a,r,n,o,e.getUint32(32,!0),6,0x6fa87e4f),o=b(o,a,r,n,e.getUint32(60,!0),10,0xfe2ce6e0),n=b(n,o,a,r,e.getUint32(24,!0),15,0xa3014314),r=b(r,n,o,a,e.getUint32(52,!0),21,0x4e0811a1),a=b(a,r,n,o,e.getUint32(16,!0),6,0xf7537e82),o=b(o,a,r,n,e.getUint32(44,!0),10,0xbd3af235),n=b(n,o,a,r,e.getUint32(8,!0),15,0x2ad7d2bb),r=b(r,n,o,a,e.getUint32(36,!0),21,0xeb86d391),t[0]=a+t[0]|0,t[1]=r+t[1]|0,t[2]=n+t[2]|0,t[3]=o+t[3]|0}reset(){this.state=Uint32Array.from(c),this.buffer=new DataView(new ArrayBuffer(64)),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}}function g(e,t,a,r,n,o){return((t=(t+e|0)+(r+o|0)|0)<<n|t>>>32-n)+a|0}function p(e,t,a,r,n,o,i){return g(t&a|~t&r,e,t,n,o,i)}function y(e,t,a,r,n,o,i){return g(t&r|a&~r,e,t,n,o,i)}function h(e,t,a,r,n,o,i){return g(t^a^r,e,t,n,o,i)}function b(e,t,a,r,n,o,i){return g(a^(t|~r),e,t,n,o,i)}function m(e){return btoa(Array.from(e,e=>String.fromCodePoint(e)).join(""))}function w(e){return new TextEncoder().encode(e)}a(67926);let U=async e=>{let t=new f;if("string"==typeof e)t.update(e);else if(ArrayBuffer.isView(e)||e instanceof ArrayBuffer){let a=new Blob([e]),r=await E(a);t.update(r)}else{let a=await E(e);t.update(w(a))}return function(e){return"string"==typeof e?m(w(e)):m(new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}(await t.digest())},E=e=>new Promise((t,a)=>{let r=new FileReader;r.onloadend=()=>{if(2!==r.readyState)return a(Error("Reader aborted too early"));t(r.result.split(",")[1])},r.onabort=()=>a(Error("Read aborted")),r.onerror=()=>a(r.error),r.readAsDataURL(e)});var x=a(61261),v=a(8352),C=a(99896),S=a(2954),N=a(28193),I=a(85654),T=a(79109);a(28716),a(59340);var P=a(92868),L=a(60718);let A=async(e,t)=>{let a={...await (0,L.qH)({...e,ContentType:e.ContentType??"application/octet-stream"}),...(0,L.Sl)({"content-md5":e.ContentMD5})},r=new C.o(t.url.toString());return(0,L.Nt)(!!e.Key,"Key"),r.pathname=(0,L.DB)(r,e.Key),{method:"PUT",headers:a,url:r,body:e.Body}},D=async e=>{if(!(e.statusCode>=300))return{...(0,P.Tj)(e.headers,{ETag:"etag",VersionId:"x-amz-version-id"}),$metadata:(0,v.j)(e)};{let t=await (0,I.V)(e);throw(0,P.Pu)(t,e.statusCode)}},k=(0,S.A)(T.o,A,D,{...N.sb,responseType:"text"});var $=a(26734);let B=({options:e,key:t,data:a},r,n)=>async()=>{let{bucket:o,keyPrefix:i,s3Config:s,isObjectLockEnabled:u}=await (0,x.a)(d.H,e),{contentDisposition:c,contentEncoding:f,contentType:g="application/octet-stream",metadata:p,onProgress:y}=e??{},{ETag:h,VersionId:b}=await k({...s,abortSignal:r,onUploadProgress:y,userAgentValue:(0,$.B)(l.sZ.UploadData)},{Bucket:o,Key:i+t,Body:a,ContentType:g,ContentDisposition:c,ContentEncoding:f,Metadata:p,ContentMD5:u?await U(a):void 0});return{key:t,eTag:h,versionId:b,contentType:g,metadata:p,size:n}};var j=a(48883);let O=e=>{if(!e)return o.US;let t=o.US,a=Math.ceil(e/t);for(;a>o.GE;)t*=2,a=Math.ceil(e/t);return t},M=(e,t)=>{let a=O(t);if(e instanceof Blob)return R(e,0,e.size,a);if(ArrayBuffer.isView(e))return R(e.buffer,e.byteOffset,e.byteLength,a);if(e instanceof ArrayBuffer)return R(e,0,e.byteLength,a);if("string"==typeof e){let t=new Blob([e]);return M(t,t.size)}throw new j.a({name:n.q.InvalidUploadSource,...n.u[n.q.InvalidUploadSource]})},R=function*(e,t,a,r){let n=1,o=t,i=t+Math.min(r,a);for(;i<a+t;)yield{partNumber:n,data:e.slice(o,i),size:r},n+=1,i=(o=i)+r;yield{partNumber:n,data:e.slice(o,a+t),size:a+t-o}};a(48013),a(68295);var K=a(41111),z=a(17704),V=a(68782);let _=async(e,t)=>{let a=new C.o(t.url.toString());return(0,L.Nt)(!!e.Key,"Key"),a.pathname=(0,L.DB)(a,e.Key),(0,L.Nt)(!!e.UploadId,"UploadId"),a.search=new C.g({uploadId:e.UploadId}).toString(),{method:"GET",headers:{},url:a}},q=async e=>{if(e.statusCode>=300){let t=await (0,I.V)(e);throw(0,P.Pu)(t,e.statusCode)}{let t=await (0,I.t)(e),a=(0,P.Tj)(t,{UploadId:"UploadId",Parts:["Part",e=>(0,P.y_)(e,H)]});return{$metadata:(0,v.j)(e),...a}}},H=e=>e.map(e=>(0,P.Tj)(e,{PartNumber:["PartNumber",P.vv],ETag:"ETag",Size:["Size",P.vv]})),F=(0,S.A)(T.o,_,q,{...N.sb,responseType:"text"}),G=async({cacheKey:e,s3Config:t,bucket:a,finalKey:r})=>{let n=await Z(V.ZL);if(!n[e]||n[e].lastTouched<Date.now()-36e5)return null;let i=n[e];i.lastTouched=Date.now(),await V.ZL.setItem(o.V3,JSON.stringify(n));try{let{Parts:e=[]}=await F(t,{Bucket:a,Key:r,UploadId:i.uploadId});return{parts:e,uploadId:i.uploadId}}catch(t){return z.v.debug("failed to list cached parts, removing cached upload."),await X(e),null}},Z=async e=>{try{return JSON.parse(await e.getItem(o.V3)??"{}")}catch(e){return z.v.debug("failed to parse cached uploads record."),{}}},J=({file:e,size:t,contentType:a,bucket:r,accessLevel:n,key:o})=>{let i=a??e?.type??"application/octet-stream",s=`${t}_${i}_${r}_${"guest"===n?"public":n}_${o}`;return e?`${e.name}_${e.lastModified}_${s}`:s},Q=async(e,t)=>{let a=await Z(V.ZL);a[e]={...t,lastTouched:Date.now()},await V.ZL.setItem(o.V3,JSON.stringify(a))},X=async e=>{let t=await Z(V.ZL);delete t[e],await V.ZL.setItem(o.V3,JSON.stringify(t))},W=async(e,t)=>{let a=await (0,L.qH)(e),r=new C.o(t.url.toString());return(0,L.Nt)(!!e.Key,"Key"),r.pathname=(0,L.DB)(r,e.Key),r.search="uploads",{method:"POST",headers:a,url:r}},Y=async e=>{if(e.statusCode>=300){let t=await (0,I.V)(e);throw(0,P.Pu)(t,e.statusCode)}{let t=await (0,I.t)(e),a=(0,P.Tj)(t,{UploadId:"UploadId"});return{$metadata:(0,v.j)(e),...a}}},ee=(0,S.A)(T.o,W,Y,{...N.sb,responseType:"text"}),et=async({s3Config:e,data:t,size:a,contentType:r,bucket:n,accessLevel:o,keyPrefix:i,key:s,contentDisposition:d,contentEncoding:l,metadata:u,abortSignal:c})=>{let f,g=i+s;if(void 0===a)z.v.debug("uploaded data size cannot be determined, skipping cache."),f=void 0;else{let i=J({size:a,contentType:r,file:t instanceof File?t:void 0,bucket:n,accessLevel:o,key:s}),d=await G({s3Config:e,cacheKey:i,bucket:n,finalKey:g});f=d?{...d,uploadCacheKey:i}:void 0}if(f)return{uploadId:f.uploadId,cachedParts:f.parts};{let{UploadId:i}=await ee({...e,abortSignal:c},{Bucket:n,Key:g,ContentType:r,ContentDisposition:d,ContentEncoding:l,Metadata:u});if(void 0===a)return z.v.debug("uploaded data size cannot be determined, skipping cache."),{uploadId:i,cachedParts:[]};let f=J({size:a,contentType:r,file:t instanceof File?t:void 0,bucket:n,accessLevel:o,key:s});return await Q(f,{uploadId:i,bucket:n,key:s,fileName:t instanceof File?t.name:""}),{uploadId:i,cachedParts:[]}}},ea=({size:e,onProgress:t})=>{let a=[],r=()=>a.reduce((e,t)=>e+t,0);return{getOnProgressListener:()=>{a.push(0);let n=a.length-1;return o=>{let{transferredBytes:i}=o;a[n]=i,t?.({transferredBytes:r(),totalBytes:e})}}}},er=async(e,t)=>{let a={...(0,L.Sl)({"content-md5":e.ContentMD5})};a["content-type"]="application/octet-stream";let r=new C.o(t.url.toString());return(0,L.Nt)(!!e.Key,"Key"),r.pathname=(0,L.DB)(r,e.Key),(0,L.Nt)(!!e.PartNumber,"PartNumber"),(0,L.Nt)(!!e.UploadId,"UploadId"),r.search=new C.g({partNumber:e.PartNumber+"",uploadId:e.UploadId}).toString(),{method:"PUT",headers:a,url:r,body:e.Body}},en=async e=>{if(!(e.statusCode>=300))return{...(0,P.Tj)(e.headers,{ETag:"etag"}),$metadata:(0,v.j)(e)};{let t=await (0,I.V)(e);throw(0,P.Pu)(t,e.statusCode)}},eo=(0,S.A)(T.o,er,en,{...N.sb,responseType:"text"}),ei=async({dataChunkerGenerator:e,completedPartNumberSet:t,s3Config:a,abortSignal:r,bucket:n,finalKey:o,uploadId:i,onPartUploadCompletion:s,onProgress:d,isObjectLockEnabled:l})=>{let u=0;for(let{data:c,partNumber:f,size:g}of e){if(r.aborted){z.v.debug("upload executor aborted.");break}if(t.has(f))z.v.debug(`part ${f} already uploaded.`),u+=g,d?.({transferredBytes:u});else{let{ETag:e}=await eo({...a,abortSignal:r,onUploadProgress:e=>{let{transferredBytes:t}=e;d?.({transferredBytes:u+t})}},{Bucket:n,Key:o,UploadId:i,Body:c,PartNumber:f,ContentMD5:l?await U(c):void 0});u+=g,s(f,e)}}},es="Invalid parameter for ComplteMultipartUpload API",ed=async(e,t)=>{let a=new C.o(t.url.toString());return(0,L.Nt)(!!e.Key,"Key"),a.pathname=(0,L.DB)(a,e.Key),(0,L.Nt)(!!e.UploadId,"UploadId"),a.search=new C.g({uploadId:e.UploadId}).toString(),(0,L.Nt)(!!e.MultipartUpload,"MultipartUpload"),{method:"POST",headers:{"content-type":"application/xml"},url:a,body:'<?xml version="1.0" encoding="UTF-8"?>'+el(e.MultipartUpload)}},el=e=>{if(!e.Parts?.length)throw Error(`${es}: ${e}`);return`<CompleteMultipartUpload xmlns="http://s3.amazonaws.com/doc/2006-03-01/">${e.Parts.map(eu).join("")}</CompleteMultipartUpload>`},eu=e=>{if(!e.ETag||null==e.PartNumber)throw Error(`${es}: ${e}`);return`<Part><ETag>${e.ETag}</ETag><PartNumber>${e.PartNumber}</PartNumber></Part>`},ec=async e=>{let t=await (0,I.t)(e);if(void 0!==t.Code&&void 0!==t.Message){let t=await (0,I.V)({...e,statusCode:500});throw(0,P.Pu)(t,e.statusCode)}return t},ef=async e=>{if(e.statusCode>=300){let t=await (0,I.V)(e);throw(0,P.Pu)(t,e.statusCode)}{let t=await ec(e),a=(0,P.Tj)(t,{ETag:"ETag",Key:"Key",Location:"Location"});return{$metadata:(0,v.j)(e),...a}}},eg=async(e,t)=>{if(!e)return!1;if(200===e.statusCode){if(!e.body)return!0;let t=await (0,I.t)(e);return void 0!==t.Code&&void 0!==t.Message}return(0,N.sb.retryDecider)(e,t)},ep=(0,S.A)(T.o,ed,ef,{...N.sb,responseType:"text",retryDecider:eg}),ey=async e=>{if(!(e.statusCode>=300))return{$metadata:(0,v.j)(e)};{let t=await (0,I.V)(e);throw(0,P.Pu)(t,e.statusCode)}},eh=(0,S.A)(T.o,(e,t)=>{let a=new C.o(t.url.toString());return(0,L.Nt)(!!e.Key,"Key"),a.pathname=(0,L.DB)(a,e.Key),(0,L.Nt)(!!e.UploadId,"UploadId"),a.search=new C.g({uploadId:e.UploadId}).toString(),{method:"DELETE",headers:{},url:a}},ey,{...N.sb,responseType:"text"}),eb=async(e,t)=>{let a=new C.o(t.url.toString());return(0,L.Nt)(!!e.Key,"Key"),a.pathname=(0,L.DB)(a,e.Key),{method:"HEAD",headers:{},url:a}},em=async e=>{if(e.statusCode>=300){let t=await (0,I.V)(e);throw(0,P.Pu)(t,e.statusCode)}{let t={...(0,P.Tj)(e.headers,{ContentLength:["content-length",P.vv],ContentType:"content-type",ETag:"etag",LastModified:["last-modified",P.El],VersionId:"x-amz-version-id"}),Metadata:(0,P.nl)(e.headers)};return{$metadata:(0,v.j)(e),...t}}},ew=(0,S.A)(T.o,eb,em,{...N.sb,responseType:"text"}),eU=({options:e,key:t,data:a},r)=>{let n,i,s,u,c,f,g,p,y=!1,h=async()=>{let n=await (0,x.a)(d.H,e);u=n.s3Config,f=n.bucket,g=n.keyPrefix,c=new AbortController,y=!1;let{contentDisposition:i,contentEncoding:h,contentType:b="application/octet-stream",metadata:m,accessLevel:w,onProgress:U}=e??{};if(!s){let{uploadId:e,cachedParts:n}=await et({s3Config:u,accessLevel:eE(w),bucket:f,keyPrefix:g,key:t,contentType:b,contentDisposition:i,contentEncoding:h,metadata:m,data:a,size:r,abortSignal:c.signal});s={uploadId:e,completedParts:n}}let E=g+t;p=r?J({file:a instanceof File?a:void 0,accessLevel:eE(e?.accessLevel),contentType:e?.contentType,bucket:f,size:r,key:t}):void 0;let v=M(a,r),C=new Set(s.completedParts.map(({PartNumber:e})=>e)),S=(e,t)=>{s?.completedParts.push({PartNumber:e,ETag:t})},N=ea({size:r,onProgress:U}),I=[];for(let e=0;e<o.Ek;e++)I.push(ei({dataChunkerGenerator:v,completedPartNumberSet:C,s3Config:u,abortSignal:c.signal,bucket:f,finalKey:E,uploadId:s.uploadId,onPartUploadCompletion:S,onProgress:N.getOnProgressListener(),isObjectLockEnabled:n.isObjectLockEnabled}));await Promise.all(I);let{ETag:T}=await ep({...u,abortSignal:c.signal,userAgentValue:(0,$.B)(l.sZ.UploadData)},{Bucket:f,Key:E,UploadId:s.uploadId,MultipartUpload:{Parts:s.completedParts.sort((e,t)=>e.PartNumber-t.PartNumber)}});if(r){let{ContentLength:e}=await ew(u,{Bucket:f,Key:E});if(e&&e!==r)throw new j.a({name:"Error",message:`Upload failed. Expected object size ${r}, but got ${e}.`})}return p&&await X(p),{key:t,eTag:T,contentType:b,metadata:m}},b=()=>h().then(n).catch(e=>{let t=c?.signal;t?.aborted&&y?z.v.debug("upload paused."):i(e)});return{multipartUploadJob:()=>new Promise((e,t)=>{n=e,i=t,b()}),onPause:()=>{y=!0,c?.abort()},onResume:()=>{b()},onCancel:e=>{c?.abort(e),(async()=>{p&&await X(p),await eh(u,{Bucket:f,Key:g+t,UploadId:s?.uploadId})})().catch(e=>{z.v.debug("error when cancelling upload task.",e)}),i(new K.k(e?{message:e}:void 0))}}},eE=e=>e??d.H.libraryOptions.Storage?.S3?.defaultAccessLevel??o.eQ,ex=e=>{let{data:t}=e,a=s(t);if((0,r.M)(void 0===a||a<=o.ju,n.q.ObjectIsTooLarge),a&&a<=o.US){let t=new AbortController;return(0,i.D)({isMultipartUpload:!1,job:B(e,t.signal,a),onCancel:e=>{t.abort(e)}})}{let{multipartUploadJob:t,onPause:r,onResume:n,onCancel:o}=eU(e,a);return(0,i.D)({isMultipartUpload:!0,job:t,onCancel:e=>{o(e)},onPause:r,onResume:n})}}},16218:(e,t,a)=>{a.d(t,{D:()=>s,k:()=>i});var r=a(41111),n=a(17704);let o=({job:e,onCancel:t})=>{let a,o={cancel:e=>{let{state:r}=o;if("CANCELED"===r||"ERROR"===r||"SUCCESS"===r)return void n.v.debug(`This task cannot be canceled. State: ${r}`);o.state="CANCELED",t(a=e)},state:"IN_PROGRESS"},i=(async()=>{try{let t=await e();return o.state="SUCCESS",t}catch(e){throw(0,r.n)(e)&&(o.state="CANCELED",e.message=a??e.message),o.state="ERROR",e}})();return Object.assign(o,{result:i})},i=o,s=({job:e,onCancel:t,onResume:a,onPause:r,isMultipartUpload:i})=>{let s=Object.assign(o({job:e,onCancel:t}),{pause:()=>{let{state:e}=s;if(!i||"IN_PROGRESS"!==e)return void n.v.debug(`This task cannot be paused. State: ${e}`);s.state="PAUSED",r?.()},resume:()=>{let{state:e}=s;if(!i||"PAUSED"!==e)return void n.v.debug(`This task cannot be resumed. State: ${e}`);s.state="IN_PROGRESS",a?.()}});return s}},17704:(e,t,a)=>{a.d(t,{v:()=>r});let r=new(a(29293)).C("Storage")},26734:(e,t,a)=>{a.d(t,{B:()=>o});var r=a(85286),n=a(46199);function o(e){return(0,r.fE)({category:n.b7.Storage,action:e})}},28193:(e,t,a)=>{a.d(t,{sb:()=>g});var r=a(99896),n=a(85286),o=a(79096),i=a(74172),s=a(14330),d=a(85654);a(28716),a(59340);let l=/^[a-z0-9][a-z0-9\.\-]{1,61}[a-z0-9]$/,u=/(\d+\.){3}\d+/,c=/\.\./,f=e=>l.test(e)&&!u.test(e)&&!c.test(e),g={service:"s3",endpointResolver:(e,t)=>{let a,{region:n,useAccelerateEndpoint:i,customEndpoint:s,forcePathStyle:d}=e;if(s)a=new r.o(s);else if(i){if(d)throw Error("Path style URLs are not supported with S3 Transfer Acceleration.");a=new r.o(`https://s3-accelerate.${(0,o.R)(n)}`)}else a=new r.o(`https://s3.${n}.${(0,o.R)(n)}`);if(t?.Bucket){if(!f(t.Bucket))throw Error(`Invalid bucket name: "${t.Bucket}".`);d||t.Bucket.includes(".")?a.pathname=`/${t.Bucket}`:a.host=`${t.Bucket}.${a.host}`}return{url:a}},retryDecider:(0,i.D)(d.V),computeDelay:s.y,userAgentValue:(0,n.fE)(),useAccelerateEndpoint:!1,uriEscapePath:!1}},41111:(e,t,a)=>{a.d(t,{k:()=>n,n:()=>o});var r=a(48883);class n extends r.a{constructor(e={}){super({name:"CanceledError",message:"Upload is canceled by user",...e}),this.constructor=n,Object.setPrototypeOf(this,n.prototype)}}let o=e=>!!e&&e instanceof n},44449:(e,t,a)=>{a.d(t,{M:()=>o});var r=a(8045),n=a(61335);let o=e=>null==e?r.fM:i(e)?(0,n.h)(null,e):r.z8,i=e=>"string"==typeof e||ArrayBuffer.isView(e)||s(e),s=e=>"function"==typeof ArrayBuffer&&e instanceof ArrayBuffer||"[object ArrayBuffer]"===Object.prototype.toString.call(e)},48883:(e,t,a)=>{a.d(t,{a:()=>n});var r=a(61848);class n extends r.x{constructor(e){super(e),this.constructor=n,Object.setPrototypeOf(this,n.prototype)}}},52595:(e,t,a)=>{a.d(t,{z:()=>w});let r=e=>Object.keys(e).map(e=>e.toLowerCase()).sort().join(";");var n=a(8045);let o=(e,t,a)=>`${e}/${t}/${a}/${n.VQ}`,i=e=>{let t=e.toISOString().replace(/[:\-]|\.\d{3}/g,"");return{longDate:t,shortDate:t.slice(0,8)}},s=({credentials:e,signingDate:t=new Date,signingRegion:a,signingService:r,uriEscapePath:n=!0})=>{let{accessKeyId:s,secretAccessKey:d,sessionToken:l}=e,{longDate:u,shortDate:c}=i(t);return{accessKeyId:s,credentialScope:o(c,a,r),longDate:u,secretAccessKey:d,sessionToken:l,shortDate:c,signingRegion:a,signingService:r,uriEscapePath:n}};var d=a(61335);let l=e=>Object.entries(e).map(([e,t])=>({key:e.toLowerCase(),value:t?.trim().replace(/\s+/g," ")??""})).sort((e,t)=>e.key<t.key?-1:1).map(e=>`${e.key}:${e.value}
`).join(""),u=e=>Array.from(e).sort(([e,t],[a,r])=>e===a?t<r?-1:1:e<a?-1:1).map(([e,t])=>`${c(e)}=${c(t)}`).join("&"),c=e=>encodeURIComponent(e).replace(/[!'()*]/g,f),f=e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`,g=(e,t=!0)=>e?t?encodeURIComponent(e).replace(/%2F/g,"/"):e:"/";var p=a(44449);let y=({body:e,headers:t,method:a,url:n},o=!0)=>[a,g(n.pathname,o),u(n.searchParams),l(t),r(t),(0,p.M)(e)].join("\n"),h=(e,t,a,r)=>{let o=`${n.nt}${e}`,i=(0,d.I)(o,t),s=(0,d.I)(i,a),l=(0,d.I)(s,r);return(0,d.I)(l,n.VQ)},b=(e,t,a)=>[n.EK,e,t,a].join("\n"),m=(e,{credentialScope:t,longDate:a,secretAccessKey:r,shortDate:n,signingRegion:o,signingService:i,uriEscapePath:s})=>{let l=y(e,s),u=b(a,t,(0,d.h)(null,l));return(0,d.h)(h(r,n,o,i),u)},w=(e,t)=>{let a=s(t),{accessKeyId:o,credentialScope:i,longDate:d,sessionToken:l}=a,u={...e.headers};u[n.zX]=e.url.host,u[n.ot]=d,l&&(u[n.wE]=l);let c={...e,headers:u},f=m(c,a),g=`Credential=${o}/${i}`,p=`SignedHeaders=${r(u)}`,y=`Signature=${f}`;return u[n.H1]=`${n.EK} ${g}, ${p}, ${y}`,c}},60718:(e,t,a)=>{a.d(t,{Sl:()=>s,qH:()=>d,DB:()=>u,Nt:()=>c});let r=e=>encodeURIComponent(e).replace(/[!'()*]/g,n),n=e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`;var o=a(98711),i=a(48883);let s=e=>{let t={};for(let[a,r]of Object.entries(e))null!=r&&(t[a]=r.toString());return t},d=async e=>({...s({"x-amz-acl":e.ACL,"cache-control":e.CacheControl,"content-disposition":e.ContentDisposition,"content-language":e.ContentLanguage,"content-encoding":e.ContentEncoding,"content-type":e.ContentType,expires:e.Expires?.toUTCString(),"x-amz-tagging":e.Tagging,...l(e.Metadata)})}),l=(e={})=>Object.keys(e).reduce((t,a)=>(t[`x-amz-meta-${a.toLowerCase()}`]=e[a],t),{}),u=(e,t)=>e.pathname.replace(/\/$/,"")+`/${t.split("/").map(r).join("/")}`;function c(e,t){if(!e)throw new i.a({name:o.m.Unknown,message:"An unknown error has occurred.",underlyingError:TypeError(`Expected a non-null value for S3 parameter ${t}`),recoverySuggestion:"This is likely to be a bug. Please reach out to library authors."})}},61261:(e,t,a)=>{a.d(t,{a:()=>s});var r=a(73623),n=a(13971),o=a(95677);let i=({accessLevel:e,targetIdentityId:t})=>"private"===e?((0,r.M)(!!t,n.q.NoIdentityId),`private/${t}/`):"protected"===e?((0,r.M)(!!t,n.q.NoIdentityId),`protected/${t}/`):"public/",s=async(e,t)=>{let{credentials:a,identityId:s}=await e.Auth.fetchAuthSession({forceRefresh:!1});(0,r.M)(!!a,n.q.NoCredentials),(0,r.M)(!!s,n.q.NoIdentityId);let{bucket:d,region:l,dangerouslyConnectToHttpEndpointForTesting:u}=e.getConfig()?.Storage?.S3??{};(0,r.M)(!!d,n.q.NoBucket),(0,r.M)(!!l,n.q.NoRegion);let{defaultAccessLevel:c,prefixResolver:f=i,isObjectLockEnabled:g}=e.libraryOptions?.Storage?.S3??{},p=await f({accessLevel:t?.accessLevel??c??o.eQ,targetIdentityId:t?.accessLevel==="protected"?t?.targetIdentityId??s:s});return{s3Config:{credentials:a,region:l,useAccelerateEndpoint:t?.useAccelerateEndpoint,...u?{customEndpoint:o.YE,forcePathStyle:!0}:{}},bucket:d,keyPrefix:p,isObjectLockEnabled:g}}},61335:(e,t,a)=>{a.d(t,{I:()=>o,h:()=>i});var r=a(84127),n=a(68021);let o=(e,t)=>{let a=new r.I(e??void 0);return a.update(t),a.digestSync()},i=(e,t)=>{let a=o(e,t);return(0,n.n)(a)}},72113:(e,t,a)=>{a.d(t,{_:()=>s});var r=a(52595);a(84127),a(68021);let n=e=>new Date(Date.now()+e),o=(e,t)=>Math.abs(n(t).getTime()-e)>=3e5,i=(e,t)=>o(e,t)?e-Date.now():t,s=({credentials:e,region:t,service:a,uriEscapePath:o=!0})=>{let s;return l=>async function(u){s=s??0;let c={credentials:"function"==typeof e?await e():e,signingDate:n(s),signingRegion:t,signingService:a,uriEscapePath:o},f=await (0,r.z)(u,c),g=await l(f),p=d(g);return p&&(s=i(Date.parse(p),s)),g}},d=({headers:e}={})=>e?.date??e?.Date??e?.["x-amz-date"]},73623:(e,t,a)=>{a.d(t,{M:()=>o});var r=a(13971),n=a(48883);function o(e,t){let{message:a,recoverySuggestion:o}=r.u[t];if(!e)throw new n.a({name:t,message:a,recoverySuggestion:o})}},79109:(e,t,a)=>{a.d(t,{o:()=>U});var r=a(52899),n=a(12685),o=a(72113),i=a(82590),s=a(44449);let d="Network Error",l="Request aborted",u="x-amz-content-sha256";var c=a(31031),f=a(29293),g=a(41111);let p=new f.C("xhr-http-handler"),y=e=>({transferredBytes:e.loaded,totalBytes:e.lengthComputable?e.total:void 0}),h=(e,t)=>{let a=Error(e);return a.name=t,a},b=e=>e?e.split("\r\n").reduce((e,t)=>{let a=t.split(": "),r=a.shift(),n=a.join(": ");return e[r.toLowerCase()]=n,e},{}):{},m=e=>{let t=new FileReader;return new Promise((a,r)=>{t.onloadend=()=>{t.readyState===FileReader.DONE&&a(t.result)},t.onerror=()=>{r(t.error)},t.readAsText(e)})},w=["host"],U=(0,i.q)((e,t)=>{let{url:a,method:r,headers:n,body:o}=e,{onDownloadProgress:i,onUploadProgress:s,responseType:u,abortSignal:f}=t;return new Promise((e,t)=>{let U=new XMLHttpRequest;if(U.open(r.toUpperCase(),a.toString()),Object.entries(n).filter(([e])=>!w.includes(e)).forEach(([e,t])=>{U.setRequestHeader(e,t)}),U.responseType=u,i&&U.addEventListener("progress",e=>{i(y(e)),p.debug(e)}),s&&U.upload.addEventListener("progress",e=>{s(y(e)),p.debug(e)}),U.addEventListener("error",()=>{let e=h(d,"ECONNABORTED");p.error(d),t(e),U=null}),U.addEventListener("abort",()=>{if(!U||f?.aborted)return;let e=h(l,"ERR_ABORTED");p.error(l),t(e),U=null}),U.addEventListener("readystatechange",()=>{U&&U.readyState===U.DONE&&setTimeout(()=>{if(!U)return;let t=b(U.getAllResponseHeaders()),a=U.responseType,r=U.response,n="text"===a?U.responseText:"",o={blob:()=>Promise.resolve(r),text:(0,c.n)(()=>"blob"===a?m(r):Promise.resolve(n)),json:()=>Promise.reject(Error("Parsing response to JSON is not implemented. Please use response.text() instead."))};e({statusCode:U.status,headers:t,body:"blob"===U.responseType?Object.assign(r,o):o}),U=null})}),f){let e=()=>{U&&(t(new g.k({name:"ERR_CANCELED",message:"canceled"})),U.abort(),U=null)};f.aborted?e():f.addEventListener("abort",e)}if("function"==typeof ReadableStream&&o instanceof ReadableStream)throw Error("ReadableStream request payload is not supported.");U.send(o??null)})},[e=>e=>async function(t){if(t.headers[u])return e(t);{let a=await (0,s.M)(t.body);return t.headers[u]=a,e(t)}},r.L,n.D,o._])},85654:(e,t,a)=>{a.d(t,{t:()=>f,V:()=>c});var r=a(8352);let n={parse:e=>{let t=o(new DOMParser().parseFromString(e,"text/xml")),a=Object.keys(t)[0];return t[a]}},o=e=>{if(s(e))return{[e.documentElement.nodeName]:o(e.documentElement)};if(e.nodeType===Node.TEXT_NODE)return e.nodeValue?.trim();if(i(e)){if(d(e))return e.childNodes[0]?.nodeValue;let t={};for(let a=0;a<e.attributes.length;a++){let r=e.attributes[a];u(r.nodeName)||(t[r.nodeName]=r.nodeValue)}if(e.children.length>0)for(let a=0;a<e.children.length;a++){let r=e.children[a],n=o(r);if(void 0===n)continue;let i=r.nodeName;void 0===t[i]?t[i]=n:Array.isArray(t[i])?t[i].push(n):t[i]=[t[i],n]}return 0===Object.keys(t).length?"":t}},i=e=>e.nodeType===Node.ELEMENT_NODE,s=e=>e.nodeType===Node.DOCUMENT_NODE,d=e=>l(e)&&0===e.children.length&&e.firstChild?.nodeType===Node.TEXT_NODE,l=e=>{for(let t=0;t<e.attributes.length;t++)if(!u(e.attributes[t].nodeName))return!1;return!0},u=e=>"xmlns"===e||e.startsWith("xmlns:");a(14698);let c=async e=>{if(!e||e.statusCode<300)return;let{statusCode:t}=e,a=await f(e),n=a?.Code?a.Code:404===t?"NotFound":t.toString();return Object.assign(Error(a?.message??a?.Message??n),{name:n,$metadata:(0,r.j)(e)})},f=async e=>{if(!e.body)throw Error("S3 aborted request.");let t=await e.body.text();if(t?.length>0)try{return n.parse(t)}catch(e){throw Error("Failed to parse XML response.")}return{}}},92868:(e,t,a)=>{a.d(t,{El:()=>s,OI:()=>i,Pu:()=>u,Tj:()=>n,nl:()=>l,vv:()=>o,y_:()=>d});var r=a(48883);let n=(e,t)=>{let a={};for(let[r,n]of Object.entries(t)){let[t,o]=Array.isArray(n)?n:[n];e.hasOwnProperty(t)&&(a[r]=o?o(e[t]):String(e[t]))}return a},o=e=>e?Number(e):void 0,i=e=>e?"true"===e:void 0,s=e=>e?new Date(e):void 0,d=(e,t)=>""===e?[]:t((Array.isArray(e)?e:[e]).filter(e=>null!=e)),l=e=>{let t="x-amz-meta-",a=Object.keys(e).filter(e=>e.startsWith(t)).reduce((a,r)=>(a[r.replace(t,"")]=e[r],a),{});return Object.keys(a).length>0?a:void 0},u=(e,t)=>{let a=new r.a({name:e.name,message:e.message});return 404===t&&(a.recoverySuggestion="Please add the object with this key to the bucket as the key is not found."),a}},95677:(e,t,a)=>{a.d(t,{Ek:()=>d,GE:()=>s,US:()=>o,V3:()=>l,YE:()=>r,eQ:()=>n,ju:()=>i});let r="http://localhost:20005",n="guest",o=5242880,i=0x50000000000,s=1e4,d=4,l="__uploadInProgress"}}]);